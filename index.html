<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">

  <title>Java container optimization</title>

  <meta name="description" content="">
  <meta name="author" content="">

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <!-- REVEAL CSS-->
  <link rel="stylesheet" href="libs/reveal.js/font-awesome-4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="libs/reveal.js/3.8.0/css/reveal.css">
  
  <link rel="stylesheet" href="libs/reveal.js/3.8.0/css/theme/league.css" id="theme">
  
  
  <link rel="stylesheet" href="libs/reveal.js/3.8.0/plugin/title-footer/title-footer-mod.css" />

  <!-- MERMAID-->
  <script src="libs/reveal.js/3.8.0/plugin/mermaid/mermaid.min.js"></script>
  <style>
  .mermaid {
    font-size: 0.5em;
  }
  </style>

  <style>
    [class*=task-list-item] {
    min-height: 22px;
    margin-top: 6px!important;
    margin-bottom: 6px!important;
    padding-left: 0;
    list-style: none;
}

[class*=task-list-item]>input:first-child {
    position: absolute!important;
    opacity: 0;
    margin: 0;
}
[class*=task-list-item]>label {
    padding-left: 29px!important;
    min-height: 22px;
    line-height: 22px;
    display: inline-block;
    position: relative;
    vertical-align: top;
    margin-bottom: 0;
    font-weight: 400;
    cursor: pointer;
}

.task-list-item>input:first-child:checked+input[type=hidden]+label::before, .task-list-item>input:first-child:checked+label::before {
    background-color: #ecf0f1;
    border-color: #ecf0f1;
}

[class*=task-list-item]>input:first-child+input[type=hidden]+label::before, [class*=task-list-item]>input:first-child+label::before {
    content: "";
    display: inline-block;
    position: absolute;
    width: 22px;
    height: 22px;
    border: 1px solid #D3CFC8;
    border-radius: 0;
    margin-left: -29px;
}


[class*=task-list-item]>input:first-child:checked+input[type=hidden]+label::after, [class*=task-list-item]>input:first-child:checked+label::after {
    content: "";
    display: inline-block;
    position: absolute;
    top: 0;
    left: 0;
    width: 7px;
    height: 10px;
    border: 2px solid #fff;
    border-left: none;
    border-top: none;
    transform: translate(7.75px,4.5px) rotate(45deg);
    -ms-transform: translate(7.75px,4.5px) rotate(45deg);
}


.task-list-item>input:first-child:checked+input[type=hidden]+label::after, .task-list-item>input:first-child:checked+label::after {
    border-bottom-color: #95a5a6;
    border-right-color: #95a5a6;
}
  </style>

  <!-- Theme used for syntax highlighting of code -->
  
  <link rel="stylesheet" href="libs/highlight.js/9.12.0/monokai.css">
  

  
  
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement('link');
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match(/print-pdf/gi) ? 'libs/reveal.js/3.8.0/css/print/pdf.css' : 'libs/reveal.js/3.8.0/css/print/paper.css';
    document.getElementsByTagName('head')[0].appendChild(link);
  </script>

  <style>
    /* Solarized Light theme */
     .line {
      display: block;
    }
    

    .line.focus {
      background: #fdf6e3;
      color: #657b83;
    }

/*
    .line.focus .hljs-comment,
    .line.focus .hljs-quote {
      color: #93a1a1;
    }

    .line.focus .hljs-keyword,
    .line.focus .hljs-selector-tag,
    .line.focus .hljs-addition {
      color: #859900;
    }

    .line.focus .hljs-number,
    .line.focus .hljs-string,
    .line.focus .hljs-meta .hljs-meta-string,
    .line.focus .hljs-literal,
    .line.focus .hljs-doctag,
    .line.focus .hljs-regexp {
      color: #2aa198;
    }

    .line.focus .hljs-title,
    .line.focus .hljs-section,
    .line.focus .hljs-name,
    .line.focus .hljs-selector-id,
    .line.focus .hljs-selector-class {
      color: #268bd2;
    }

    .line.focus .hljs-attribute,
    .line.focus .hljs-attr,
    .line.focus .hljs-variable,
    .line.focus .hljs-template-variable,
    .line.focus .hljs-class .hljs-title,
    .line.focus .hljs-type {
      color: #b58900;
    }

    .line.focus .hljs-symbol,
    .line.focus .hljs-bullet,
    .line.focus .hljs-subst,
    .line.focus .hljs-meta,
    .line.focus .hljs-meta .hljs-keyword,
    .line.focus .hljs-selector-attr,
    .line.focus .hljs-selector-pseudo,
    .line.focus .hljs-link {
      color: #cb4b16;
    }

    .line.focus .hljs-built_in,
    .line.focus .hljs-deletion {
      color: #dc322f;
    }

    .line.focus .hljs-formula {
      background: #eee8d5;
    }

    .line.focus .hljs-emphasis {
      font-style: italic;
    }

    .line.focus .hljs-strong {
      font-weight: bold;
    }

    .yellow-slide .line.focus:nth-child(2) {
      background: yellow;
    }

    .reveal .slides section .code-presenting-annotation {
      font-size: 70%;
    }
    */

    .reveal .slides section .fragment.current-only {
      visibility: visible;
      display: none;
    }

    .reveal .slides section .fragment.current-only.current-fragment {
      display: block;
    }

/*
    .line {
      display: block;
    }
*/
    .line.focus {
       opacity: 1.0;
    } 

    /* .hljs {
      background: none;
    } */

    /* .reveal pre {
      width: 98%;
      margin: 0px;
      box-shadow: none;
    }

    .reveal pre code {
      font-size: 1.2em;
      line-height: 1.2;
      border-radius: 10px;
      max-height: 60vh !important;
      overflow: hidden !important;
    } */

    @media (device-width: 100vw) and (device-height: 100vh) {
      .reveal pre code {
        max-height: 50vh !important;
      }
    }

    #logo img {
      max-height: 3.5em;
      max-width: none;
      min-width: 50px;
    }

    .reveal .slides section .code-presenting-annotation {
      color: white;
      background: black;
      padding: 0px 15px;
      border-radius: 15px;
      opacity: 0.75 !important;
      font-size: 50% !important;
    }
  </style>
  <script>
    if (window.location.search.match(/print-pdf-now/gi)) {
      window.print();
    }
  </script>
</head>

<body>
  

  <div class="reveal">

    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides">

      


    
        <section >
            
            <h1><a id="user-content-java-container-optimization" class="anchor" href="#java-container-optimization" aria-hidden="true"></a>Java container optimization</h1>

            </section>
    



    
    <section>
        <section >
            <h2><a id="user-content-scope" class="anchor" href="#scope" aria-hidden="true"></a>Scope</h2>

            </section>
        
            <section >
                <img class="centerImage" src="https://pixabay.com/fr/images/download/bodie-50706_640.jpg?attachment" alt="Keycloak" style="width: 40%;"/>
<span class="fragment">
<img class="centerImage" src="https://pixabay.com/fr/images/download/kia-car-2773257_640.jpg?attachment" alt="Keycloak" style="width: 40%;"/>
</span>
<aside class="notes">
Legacy
New One (microservice)
</aside>
            </section>
        

    </section>
    



    
    <section>
        <section >
            <h2><a id="user-content-goal" class="anchor" href="#goal" aria-hidden="true"></a>Goal</h2>

            </section>
        
            <section >
                <img class="centerImage" src="img/serverless-components.png" alt="Keycloak" style="width: 100%;"/>
            </section>
        
            <section >
                <p class="fragment highlight-red">Do more with less!</p>
<ul>
<li class="fragment fade-right">CPU</li>
<li class="fragment fade-right">Memory footprint</li>
<li class="fragment fade-right">IO</li>
<li class="fragment fade-right">Security</li>
</ul>

            </section>
        

    </section>
    



    
    <section>
        <section >
            <h2><a id="user-content-summary" class="anchor" href="#summary" aria-hidden="true"></a>Summary</h2>

            </section>
        
            <section >
                <h3><a id="user-content-container" class="anchor" href="#container" aria-hidden="true"></a>Container</h3>
<img class="centerImage" src="img/Rocket1.png" alt="zero" style="width: 20%;"/>
            </section>
        
            <section >
                <h3><a id="user-content-jvm" class="anchor" href="#jvm" aria-hidden="true"></a>JVM</h3>
<img class="centerImage" src="img/Rocket2.png" alt="one" style="width: 20%;"/>
            </section>
        
            <section >
                <h3><a id="user-content-framework" class="anchor" href="#framework" aria-hidden="true"></a>Framework</h3>
<img class="centerImage" src="img/Rocket3.png" alt="two" style="width: 20%;"/>
            </section>
        
            <section >
                <img class="centerImage" src="https://media2.giphy.com/media/3ohs4rclkSSrNGSlFK/200.gif" alt="rocket" style="width: 100%;"/>
            </section>
        

    </section>
    



    
    <section>
        <section >
            <h2><a id="user-content-container-1" class="anchor" href="#container-1" aria-hidden="true"></a>Container</h2>

            </section>
        
            <section >
                <h3><a id="user-content-sizing" class="anchor" href="#sizing" aria-hidden="true"></a>Sizing</h3>
<ul>
<li class="fragment fade-right">Disk storage
<ul>
<li>Registry</li>
<li>Host</li>
</ul>
</li>
<li class="fragment fade-right">Download performance
<ul>
<li>quick launch</li>
</ul>
</li>
</ul>
<aside class="notes">
* Layer duplication
* automatic pull of base image
* quick startup 
</aside>
            </section>
        
            <section >
                <h3><a id="user-content-security" class="anchor" href="#security" aria-hidden="true"></a>Security</h3>

            </section>
        
            <section >
                <blockquote>
<p>“An image should only include the executable and libraries required by the app itself; all other OS functionality is provided by the OS kernel within the underlying host OS.” -<strong>NIST</strong>-</p>
</blockquote>

            </section>
        
            <section >
                <ul>
<li>Attack surface vulnerability are limited</li>
<li class="fragment fade-right">Container immutability is guarantee</li>
<li class="fragment fade-right">Secure secret variables unreachable</li>
</ul>
<aside class="notes">
* no manual connection into a container
* no remote connection, no shell, no exposition
</aside>
            </section>
        
            <section >
                <h3><a id="user-content-strategies" class="anchor" href="#strategies" aria-hidden="true"></a>Strategies</h3>

            </section>
        
            <section >
                <h4><a id="user-content-small-base-image" class="anchor" href="#small-base-image" aria-hidden="true"></a>Small base image</h4>

            </section>
        
            <section >
                <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTlum2-EkQbcQiR0xuJAatsmiub8ky3MH8ZIjfVT-ZI6Iw2rwisZ9yolP1HPWhLX22afu22EVUUVLOd/pubhtml?gid=1361748970&single=true" style="border:0px #ffffff none;" name="Distribution" scrolling="no" frameborder="0" marginheight="0px" marginwidth="0px" height="600px" width="800px" allowfullscreen></iframe>
            </section>
        
            <section >
                <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTlum2-EkQbcQiR0xuJAatsmiub8ky3MH8ZIjfVT-ZI6Iw2rwisZ9yolP1HPWhLX22afu22EVUUVLOd/pubhtml?gid=12271636&single=true" style="border:0px #ffffff none;" name="Distribution" scrolling="no" frameborder="0" marginheight="0px" marginwidth="0px" height="400px" width="1000px" allowfullscreen></iframe>
            </section>
        
            <section >
                <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTlum2-EkQbcQiR0xuJAatsmiub8ky3MH8ZIjfVT-ZI6Iw2rwisZ9yolP1HPWhLX22afu22EVUUVLOd/pubchart?oid=1977800902&format=interactive" style="border:0px #ffffff none;" name="Distribution" scrolling="no" frameborder="0" marginheight="0px" marginwidth="0px" height="400px" width="1100px" allowfullscreen></iframe>
            </section>
        
            <section >
                <h4><a id="user-content-final-image-optimization" class="anchor" href="#final-image-optimization" aria-hidden="true"></a>Final image optimization</h4>

            </section>
        
            <section >
                <p><a href="https://github.com/docker-slim/docker-slim">Docker-slim</a></p>
<ul>
<li class="fragment fade-right">Since December 2014</li>
<li class="fragment fade-right">8 active contributors</li>
</ul>

            </section>
        
            <section >
                <pre><code class="language-bash">docker-slim build \ 
    --include-exe cut --include-exe sed \ 
    --include-path /etc/pki \
    --http-probe \
    --show-clogs \
    rh-sso/keycloak-gatekeeper70
</code></pre>

            </section>
        
            <section >
                <table>
<thead>
<tr>
<th>Project</th>
<th>Parent</th>
<th>origin</th>
<th>slim</th>
<th>x</th>
</tr>
</thead>
<tbody>
<tr>
<td>Keycloak Gatekeeper</td>
<td>CentOS</td>
<td>200</td>
<td>20</td>
<td>10</td>
</tr>
<tr>
<td rowspan="2">Keystore</td>
<td>Distroless</td>
<td>78.8</td>
<td>65.3</td>
<td>1.2</td>
</tr>
<tr>
<td>CentOS</td>
<td>248</td>
<td>65.7</td>
<td>3.8</td>
</tr>
</tbody>
</table>

            </section>
        
            <section >
                <p class="fragment highlight-green fragment fade-right">distribution agnostic</p>
<p class="fragment highlight-green fragment fade-right">reduce surface attack</p>
<p class="fragment highlight-green fragment fade-right">parent contagion</p>
<p class="fragment highlight-red fragment fade-right">scanner detection</p>
<p class="fragment highlight-red fragment fade-right">docker in docker</p>
<aside class="notes">
scanner: snyk, trivy      
</aside>
            </section>
        
            <section >
                <h4><a id="user-content-conclusion" class="anchor" href="#conclusion" aria-hidden="true"></a>Conclusion</h4>
<p class="fragment fade-in-then-out">Distroless</p>
<p class="fragment fade-in-then-out">docker-slim</p>
<p class="fragment fade-in-then-semi-out&quot;"><img src="https://media3.giphy.com/media/3ohs7TwKJyNHFG1EzK/200.gif" alt=""></p>

            </section>
        

    </section>
    



    
    <section>
        <section >
            <h2><a id="user-content-jvm-1" class="anchor" href="#jvm-1" aria-hidden="true"></a>JVM</h2>
<p><img src="https://img.stackshare.io/service/995/K85ZWV2F.png" alt=""></p>

            </section>
        
            <section >
                <h3><a id="user-content-openjdk" class="anchor" href="#openjdk" aria-hidden="true"></a>OpenJDK</h3>
<p><img src="https://cdn.arstechnica.net/wp-content/uploads/2016/01/openjdk.jpg" alt=""></p>

            </section>
        
            <section >
                <h3><a id="user-content-openjdk-hotspot" class="anchor" href="#openjdk-hotspot" aria-hidden="true"></a>OpenJDK Hotspot</h3>
<p class="fragment fade-right">free and open-source implementation of Java SE.</p>

            </section>
        
            <section >
                <ul>
<li class="fragment fade-right">From 11, Class Data Sharing</li>
<li class="fragment fade-right">Java Platform Module System - <em>Jigsaw</em> </li>
</ul>

            </section>
        
            <section >
                <h4><a id="user-content-container-friendly" class="anchor" href="#container-friendly" aria-hidden="true"></a>Container friendly</h4>
<ul>
<li class="fragment fade-in-then-out">&gt; 8u131</li>
<li class="fragment fade-right">&gt; 8u191</li>
<li class="fragment fade-right">Java 11</li>
</ul>
<aside class="notes">
current 7/2019 8u222
to disable: -XX:-UseContainerSupport
HotSpot, released as Java HotSpot Performance Engine,[1] is a Java virtual machine for desktop and server computers, maintained and distributed by Oracle Corporation. It features improved performance via methods such as just-in-time compilation and adaptive optimization.
</aside>
            </section>
        
            <section >
                <h3><a id="user-content-eclipse-openj9" class="anchor" href="#eclipse-openj9" aria-hidden="true"></a>Eclipse OpenJ9</h3>
<p class="fragment fade-right">high performance, scalable, JVM implementation that is fully compliant with the Java Virtual Machine Specification.</p>

            </section>
        
            <section >
                <ul>
<li class="fragment fade-right">JDK 8-11</li>
<li class="fragment fade-right">Container friendly</li>
<li class="fragment fade-right">Class Data Sharing</li>
<li class="fragment fade-right">Dynamic Ahead-Of-Time</li>
<li class="fragment fade-right">Startup mode (quick, virtualized)</li>
</ul>
<aside class="notes">
dAOT Update Shared Class Cache at runtime. Runs once, benefit to others.
Just as with JIT compilations, the compiler only AOT compiles methods that have been executed a certain number of times.
</aside>
            </section>
        
            <section >
                <h3><a id="user-content-graalvm" class="anchor" href="#graalvm" aria-hidden="true"></a>GraalVM</h3>
<p><img src="https://miro.medium.com/max/655/1*eIW3gooOD5kApk7qw_82lg.png" alt=""></p>
<p class="fragment fade-right">next generation Hotspot VM.</p>

            </section>
        
            <section >
                <ul>
<li>Platform</li>
<li class="fragment fade-right">Polyglot</li>
<li class="fragment fade-right">Graal compiler</li>
<li class="fragment fade-right">Community / Enterprise edition</li>
</ul>
<aside class="notes">
"client", aussi nommé "C1". Il est utilisé pour les applications desktop, ayant une faible durée de vie (comptée en heures).  Dans ce mode, la JVM démarre plus rapidement mais n’effectue que peu d’optimisations sur le code et a pour objectif de ne pas utiliser beaucoup de ressources matérielles.
<p>“server”, aussi appelé “C2” ou “opto”. Il est utilisé sur les serveurs, pour lesquels la durée de vie est bien plus longue (comptée en jours). Dans ce mode, la JVM démarre plus lentement compte tenu des optimisations effectuées pour atteindre le point d’équilibre.  La limitation sur les ressources matérielles du mode client n’existe plus ici : toutes les optimisations possibles sont activées.
Java replacement of C2 C++: long time performance)
Polyglot -&gt; Truffle -&gt; python, java, rust, NodeJS</p>
</aside>
            </section>
        
            <section >
                <p>Native image</p>
<p><img src="https://miro.medium.com/max/710/1*0gfk2o71BRI8ny8HI4_Wlg.png" alt="" class="fragment fade-right"></p>
<ul>
<li class="fragment fade-right">library</li>
<li class="fragment fade-right">full</li>
</ul>
<aside class="notes">
Native image -> Static Ahead Of Time with Substrate VM
</aside>
            </section>
        
            <section >
                <h3><a id="user-content-lts--production-ready" class="anchor" href="#lts--production-ready" aria-hidden="true"></a>LTS / Production Ready</h3>
<ul>
<li class="fragment fade-right">OpenJDK 8: end Q3 2023</li>
<li class="fragment fade-right">OpenJDK 11: end Q4 2022-2024</li>
<li class="fragment fade-right">OpenJDK 17: init Q3 2021</li>
<li class="fragment fade-right">GraalVM: init 2019
<ul>
<li class="fragment fade-right">v19 support 8 only</li>
<li class="fragment fade-right">11 work in progress </li>
</ul>
</li>
</ul>
<aside class="notes">
(Hotsport/OpenJ9)
[Support](https://docs.google.com/spreadsheets/d/e/2PACX-1vTlum2-EkQbcQiR0xuJAatsmiub8ky3MH8ZIjfVT-ZI6Iw2rwisZ9yolP1HPWhLX22afu22EVUUVLOd/pubhtml?gid=1089879229&single=true)
cycle de 3 ans
</aside>
            </section>
        
            <section >
                <h3><a id="user-content-performance" class="anchor" href="#performance" aria-hidden="true"></a>Performance</h3>

            </section>
        
            <section >
                <h4><a id="user-content-methods" class="anchor" href="#methods" aria-hidden="true"></a>Methods</h4>

            </section>
        
            <section >
                <ul>
<li>Differents use cases:
<ul>
<li class="fragment fade-right">Stream only </li>
<li class="fragment fade-right">Microprofile </li>
<li class="fragment fade-right">SpringBoot </li>
<li class="fragment fade-right">RH-SSO 7.3 </li>
</ul>
</li>
</ul>

            </section>
        
            <section >
                <ul>
<li><strong>Two</strong> automatic measures:
<ul>
<li>Start time o process time</li>
<li>Memory</li>
<li>Latency (mean, 50%, 90%)</li>
<li>Throughput</li>
</ul>
</li>
</ul>

            </section>
        
            <section >
                <h4><a id="user-content-results" class="anchor" href="#results" aria-hidden="true"></a>Results</h4>

            </section>
        
            <section >
                <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTlum2-EkQbcQiR0xuJAatsmiub8ky3MH8ZIjfVT-ZI6Iw2rwisZ9yolP1HPWhLX22afu22EVUUVLOd/pubhtml?gid=338344574&single=true" style="border:0px #ffffff none;" name="Stream" scrolling="no" frameborder="0" marginheight="0px" marginwidth="0px" height="300px" width="500px" allowfullscreen></iframe>
            </section>
        
            <section >
                <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTlum2-EkQbcQiR0xuJAatsmiub8ky3MH8ZIjfVT-ZI6Iw2rwisZ9yolP1HPWhLX22afu22EVUUVLOd/pubhtml?gid=898376284&single=true" style="border:0px #ffffff none;" name="Microprofile" scrolling="no" frameborder="0" marginheight="0px" marginwidth="0px" height="600px" width="1000px" allowfullscreen></iframe>
            </section>
        
            <section >
                <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTlum2-EkQbcQiR0xuJAatsmiub8ky3MH8ZIjfVT-ZI6Iw2rwisZ9yolP1HPWhLX22afu22EVUUVLOd/pubhtml?gid=1814932109&single=true" style="border:0px #ffffff none;" name="Spring Boot" scrolling="no" frameborder="0" marginheight="0px" marginwidth="0px" height="600px" width="1000px" allowfullscreen></iframe>
            </section>
        
            <section >
                <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTlum2-EkQbcQiR0xuJAatsmiub8ky3MH8ZIjfVT-ZI6Iw2rwisZ9yolP1HPWhLX22afu22EVUUVLOd/pubhtml?gid=166042169&single=true" style="border:0px #ffffff none;" name="RH-SSO7.3" scrolling="no" frameborder="0" marginheight="0px" marginwidth="0px" height="300px" width="500px" allowfullscreen></iframe>
            </section>
        
            <section >
                <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTlum2-EkQbcQiR0xuJAatsmiub8ky3MH8ZIjfVT-ZI6Iw2rwisZ9yolP1HPWhLX22afu22EVUUVLOd/pubhtml?gid=2071947112&single=true" style="border:0px #ffffff none;" name="Results" scrolling="no" frameborder="0" marginheight="0px" marginwidth="0px" height="300px" width="600px" allowfullscreen></iframe>
            </section>
        
            <section >
                <h5><a id="user-content-jre" class="anchor" href="#jre" aria-hidden="true"></a>JRE</h5>
<p class="fragment highlight-red"><strong>OpenJDK 8</strong></p>
<p class="fragment highlight-green"><strong>OpenJDK 11</strong></p>
<p class="fragment highlight-blue"><strong>OpenJ9</strong> </p>
<p><strong>GraalVM</strong></p>
<aside class="notes">
OpenJDK 8: deprecated
OpenJDK 11: default
OpenJ9: focus on memory usage
GraalVM: wait to see (OpenJDK integration)
</aside>
            </section>
        
            <section >
                <h3><a id="user-content-java-platform-module-system" class="anchor" href="#java-platform-module-system" aria-hidden="true"></a>Java Platform Module System</h3>
<p><img src="https://docs.toradex.com/102686-modularity-icon.jpg" alt=""></p>
<aside class="notes">
applied app and jvm dependencies
</aside>
            </section>
        
            <section >
                <h4><a id="user-content-custom-jre" class="anchor" href="#custom-jre" aria-hidden="true"></a>Custom JRE</h4>

            </section>
        
            <section >
                <pre><code class="language-bash"># JDK11
sdk use java 11.0.4.j9-adpt &amp;&amp; du -hcs  $JAVA_HOME
# 300M    /java/11.0.4.j9-adpt
# Compile
javac CountUppercase.java
# Deps
jdeps --print-module-deps CountUppercase.class
# Generate distribution
jlink --no-header-files --no-man-pages --compress=2 --strip-debug \
 --add-modules  $(jdeps --print-module-deps CountUppercase.class) \
 --output java-base
# Custom distribution
ls java-base/ &amp;&amp; du -hcs
# bin  conf  legal  lib  release -&gt; java-base/ 39M
JAVA_HOME=$PWD/java-base
</code></pre>
<aside class="notes">
30MB instead of 116MB ( JRE size) and 320MB for a full JDK.
</aside>
            </section>
        

    </section>
    



    
    <section>
        <section >
            <h2><a id="user-content-java-native-frameworks" class="anchor" href="#java-native-frameworks" aria-hidden="true"></a>Java native frameworks</h2>
<p class="fragment fade-right"><strong>Native?</strong></p>

            </section>
        
            <section >
                <p class="fragment fade-in-then-out"><img src="https://img.stackshare.io/stack/443157/m1edT_tX_400x400.jpg" alt=""></p>
<p class="fragment fade-in-then-semi-out&quot;"><img class="centerImage" src="https://miro.medium.com/max/655/1*eIW3gooOD5kApk7qw_82lg.png" alt="graa" style="width: 40%;"/></p>

            </section>
        
            <section >
                <h3><a id="user-content-candidates" class="anchor" href="#candidates" aria-hidden="true"></a>Candidates</h3>

            </section>
        
            <section >
                <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTlum2-EkQbcQiR0xuJAatsmiub8ky3MH8ZIjfVT-ZI6Iw2rwisZ9yolP1HPWhLX22afu22EVUUVLOd/pubhtml?gid=675234315&single=true" style="border:0px #ffffff none;" name="Stream" scrolling="no" frameborder="0" marginheight="0px" marginwidth="0px" height="500px" width="700px" allowfullscreen></iframe>
<aside class="notes">
Krihelimeter = 	20	 * authors +
8	 * merged and proposed pull requests +
8	 * new and closed issues +
1	 * commits
alternative : spark https://www.e4developer.com/2018/06/02/the-rise-of-java-microframeworks/
</aside>
            </section>
        
            <section >
                <script type="text/javascript" src="https://ssl.gstatic.com/trends_nrtr/1937_RC01/embed_loader.js"></script> <script type="text/javascript"> trends.embed.renderExploreWidget("TIMESERIES", {"comparisonItem":[{"keyword":"quarkus","geo":"","time":"today 12-m"},{"keyword":"helidon","geo":"","time":"today 12-m"},{"keyword":"micronaut","geo":"","time":"today 12-m"}],"category":5,"property":""}, {"exploreQuery":"cat=5&q=quarkus,helidon,micronaut&date=today 12-m,today 12-m,today 12-m","guestPath":"https://trends.google.com:443/trends/embed/"}); </script> 
            </section>
        
            <section >
                <h4><a id="user-content-code" class="anchor" href="#code" aria-hidden="true"></a>Code</h4>

            </section>
        
            <section >
                <ul>
<li>Micronaut vs Quarkus</li>
</ul>
<pre><code class="language-diff">-import io.micronaut.http.annotation.Controller;
+import javax.inject.Inject; 
 
-@Controller(&quot;/conferences&quot;) 
+@Path(&quot;/conferences&quot;)
+@Produces(MediaType.APPLICATION_JSON)
 public class ConferenceController {
-    private final ConferenceService conferenceService;
+    @Inject
+    private ConferenceService conferenceService;
-    public ConferenceController(ConferenceService conferenceService) {
-        this.conferenceService = conferenceService;
-    }
-    @Get(&quot;/random&quot;) 
-    public Conference randomConf() { 
+    @Path(&quot;/random&quot;)
+    @GET
+    public Conference randomConf() { 
         return conferenceService.randomConf();
     }
 }
</code></pre>

            </section>
        
            <section >
                <ul>
<li>Quarkus vs Spring</li>
</ul>
<pre><code class="language-diff">-import io.micronaut.http.annotation.Controller;
+import org.springframework.web.bind.annotation.RequestMapping;
 
-@Controller(&quot;/conferences&quot;) 
+@RestController
 public class ConferenceController {
+    @Autowired
+    private ConferenceService conferenceService;
-    private final ConferenceService conferenceService;
-    public ConferenceController(ConferenceService conferenceService) { 
-        this.conferenceService = conferenceService;
-    }
-
-    @Get(&quot;/random&quot;) 
-    public Conference randomConf() { 
+    @RequestMapping(&quot;/conferences/random&quot;)
+    public Conference randomConf() {
         return conferenceService.randomConf();
     }
 }

</code></pre>
<aside class="notes">
https://github.com/malys/Native_Java_Framework/compare/quarkus...master
https://github.com/malys/Native_Java_Framework/compare/quarkus...spring
<p><a href="https://api.github.com/repos/malys/Native_Java_Framework/compare/master...quarkus">https://api.github.com/repos/malys/Native_Java_Framework/compare/master...quarkus</a></p>
</aside>
            </section>
        
            <section >
                <h4><a id="user-content-performance-1" class="anchor" href="#performance-1" aria-hidden="true"></a>Performance</h4>

            </section>
        
            <section >
                <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTlum2-EkQbcQiR0xuJAatsmiub8ky3MH8ZIjfVT-ZI6Iw2rwisZ9yolP1HPWhLX22afu22EVUUVLOd/pubhtml?gid=2096152561&single=true" style="border:0px #ffffff none;" name="Stream" scrolling="no" frameborder="0" marginheight="0px" marginwidth="0px" height="400px" width="900px" allowfullscreen></iframe>
<aside class="notes">
https://github.com/malys/Native_Java_Framework/compare/quarkus...master
https://github.com/malys/Native_Java_Framework/compare/quarkus...spring
<p><a href="https://api.github.com/repos/malys/Native_Java_Framework/compare/master...quarkus">https://api.github.com/repos/malys/Native_Java_Framework/compare/master...quarkus</a></p>
</aside>

            </section>
        
            <section >
                <h4><a id="user-content-quarkus" class="anchor" href="#quarkus" aria-hidden="true"></a>Quarkus</h4>
<p>Supersonic Subatomic Java</p>

            </section>
        
            <section >
                <p><img src="img/quarkus_how_to.png" alt=""></p>

            </section>
        
            <section >
                <p><img src="img/quarkus_perf.png" alt=""></p>
<aside class="notes">
Thorntail
</aside>
            </section>
        
            <section >
                <h5><a id="user-content-demo" class="anchor" href="#demo" aria-hidden="true"></a>Demo</h5>
<aside class="notes">
see notes
</aside>
            </section>
        
            <section >
                <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTlum2-EkQbcQiR0xuJAatsmiub8ky3MH8ZIjfVT-ZI6Iw2rwisZ9yolP1HPWhLX22afu22EVUUVLOd/pubhtml?gid=1079046419&single=true" style="border:0px #ffffff none;" name="Stream" scrolling="no" frameborder="0" marginheight="0px" marginwidth="0px" height="600px" width="1000px" allowfullscreen></iframe>
            </section>
        
            <section >
                <h5><a id="user-content-limitations" class="anchor" href="#limitations" aria-hidden="true"></a>Limitations</h5>

            </section>
        
            <section >
                <table>
<thead>
<tr>
<th>Not Supported</th>
<th style="text-align:center">Limited</th>
</tr>
</thead>
<tbody>
<tr>
<td>Dynamic Classloading</td>
<td style="text-align:center"><a href="https://quarkus.io/guides/cdi-reference#limitations">CDI</a></td>
</tr>
<tr>
<td><a href="https://docs.oracle.com/javase/8/docs/technotes/guides/vm/multiple-language-support.html#invokedynamic">Invoke Dynamic</a></td>
<td style="text-align:center">Reflection *</td>
</tr>
<tr>
<td><a href="https://dzone.com/articles/javas-finalizer-is-still-there">Finalizer</a></td>
<td style="text-align:center"><a href="https://www.baeldung.com/java-dynamic-proxies">Dymanic proxy</a> *</td>
</tr>
<tr>
<td><a href="https://docs.oracle.com/javase/tutorial/essential/environment/security.html">Security Manager</a></td>
<td style="text-align:center">JNI *</td>
</tr>
<tr>
<td><a href="https://docs.oracle.com/javase/8/docs/platform/jvmti/jvmti.html">JVM TI, JMX, …</a></td>
<td style="text-align:center"><a href="https://www.dummies.com/programming/java/how-to-use-static-initializers-in-java/">Static initializer</a></td>
</tr>
<tr>
<td></td>
<td style="text-align:center">Native Windows</td>
</tr>
<tr>
<td></td>
<td style="text-align:center">Native debug</td>
</tr>
</tbody>
</table>
<aside class="notes">
\* Manual list
</aside>
            </section>
        

    </section>
    



    
    <section>
        <section >
            <h2><a id="user-content-conclusion-1" class="anchor" href="#conclusion-1" aria-hidden="true"></a>Conclusion</h2>

            </section>
        
            <section >
                <p class="fragment fade-right">Quarkus + Microcontainer </p>
<p class="fragment fade-right"><img src="https://media2.giphy.com/media/Hi199DN7OU4Mg/200.gif" alt=""></p>
<aside class="notes">
Quarkus Release 1.0: 10/2019
GraalVm 19.x: production ready
</aside>
            </section>
        

    </section>
    



    
        <section >
            
            <img class="centerImage" src="./img/thank-you-2490552_1280.png"  style="width: 100%;"/>
            </section>
    



    
    <section>
        <section >
            <img class="centerImage" src="./img/question-mark-1872665_1280.jpg"  style="width: 100%;"/>

            </section>
        
            <section >
                <ul>
<li><a href="https://github.com/malys/java-native-framework-slides">Slides</a></li>
<li><a href="https://github.com/malys/Native_Java_Framework">Benchmark</a></li>
</ul>

            </section>
        

    </section>
    


    </div>


  </div>

  <script src="libs/reveal.js/3.8.0/lib/js/head.min.js"></script>
  <script src="libs/reveal.js/3.8.0/js/reveal.js"></script>

  <script>

    // More info https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({

        controls: true,
        controlsTutorial: true,
        controlsLayout: 'bottom-right',
        controlsBackArrows: 'faded',
        progress: true,
        slideNumber: true,
        history: true,
        keyboard: true,
        overview: true,
        center: true,
        touch: true,
        loop: false,
        rtl: false,
        shuffle: false,
        fragments: true,
        fragmentInURL: false,
        embedded: false,
        help: true,
        showNotes: false,
        autoPlayMedia: false,
        autoSlide: 0,
        autoSlideStoppable: true,
        autoSlideMethod: Reveal.navigateNext,
        defaultTiming: 120,
        mouseWheel: false,
        hideAddressBar: true,
        previewLinks: false,
        transition: 'slide',
        transitionSpeed: 'default',
        backgroundTransition: 'default',
        viewDistance: 3,
        parallaxBackgroundImage: '',
        parallaxBackgroundSize: '',
        parallaxBackgroundHorizontal: 0,
        parallaxBackgroundVertical: 0,
        display: 'block',

        // More info https://github.com/hakimel/reveal.js#dependencies
        dependencies: [
            // { src: 'libs/reveal.js/3.8.0/lib/js/classList.js', condition: function () { return !document.body.classList; } },
            // { src: 'libs/reveal.js/3.8.0/plugin/markdown/marked.js', condition: function () { return !!document.querySelector('[data-markdown]'); } },
            // { src: 'libs/reveal.js/3.8.0/plugin/markdown/markdown.js', condition: function () { return !!document.querySelector('[data-markdown]'); } },
            // { src: 'libs/reveal.js/3.8.0/plugin/highlight/highlight.js', async: true, callback: function () { hljs.initHighlightingOnLoad(); } },
            { src: 'libs/reveal.js/3.8.0/plugin/notes/notes.js', async: true },
            { src: 'libs/reveal.js/3.8.0/plugin/chart/Chart.min.js' },
            { src: 'libs/reveal.js/3.8.0/plugin/chart/csv2chart.js' },
            { src: 'libs/reveal.js/3.8.0/plugin/embed-tweet/embed-tweet.js' },
            { src: 'libs/reveal.js/3.8.0/plugin/math/math.js', async: true },
            { src: 'libs/highlight.js/9.12.0/highlight.js', async: true },
            { src: 'libs/reveal.js/3.8.0/plugin/anything/anything.js' },
            { src: 'libs/reveal.js/3.8.0/plugin/mermaid/mermaid.min.js', async: true, callback: function() {mermaid.initialize({startOnLoad:false})} },	

           
        { src: 'libs/reveal.js/3.8.0/plugin/search/search.js', async: true },
           

           
        { src: 'libs/reveal.js/3.8.0/plugin/zoom-js/zoom.js', async: true },
            

            
        { src: 'libs/reveal.js/3.8.0/plugin/chalkboard/chalkboard.js' },
            

            
        { src: 'libs/reveal.js/3.8.0/plugin/menu/menu.js' },
            

            
        { src: 'libs/reveal.js/3.8.0/plugin/title-footer/title-footer.js', async: true, callback: function () { title_footer.initialize(); } },
            

        {
            src: 'libs/highlight.js/9.12.0/reveal-code-focus-1.0.0-mod.js',
            async: true,
            callback: function () {
                RevealCodeFocus();
            }
        },
            // { src: 'libs/reveal.js/3.8.0/plugin/reveal-code-focus/highlight.pack.js' },
            // { src: 'libs/reveal.js/3.8.0/plugin/reveal-code-focus/reveal-code-focus.js', async: true, callback: function() { RevealCodeFocus(); } },
           // {src: 'libs/reveal.js/3.8.0/plugin/line-numbers/line-numbers.js'}
        ]
        ,
    keyboard: {
        67: function () { RevealChalkboard.toggleNotesCanvas() },	// toggle notes canvas when 'c' is pressed
        66: function () { RevealChalkboard.toggleChalkboard() },	// toggle chalkboard when 'b' is pressed
        46: function () { RevealChalkboard.clear() },	// clear chalkboard when 'DEL' is pressed
        8: function () { RevealChalkboard.reset() },	// reset chalkboard data on current slide when 'BACKSPACE' is pressed
        68: function () { RevealChalkboard.download() },	// downlad recorded chalkboard drawing when 'd' is pressed
    },
    math: {
       // mathjax: 'libs/reveal.js/3.8.0/plugin/math/MathJax.js',
             mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
            config: 'TeX-AMS_HTML-full'
    },
    chart: {
        defaults: {
            global: {
                title: { fontColor: "#FFF" },
                legend: {
                    position: "bottom",
                        labels: { fontColor: "#FFF" },
                },
                tooltips: {
                    labels: { fontColor: "#FFF" },
                },
            },
            scale: {
                scaleLabel: { fontColor: "#FFF" },
                gridLines: { color: "#FFF", zeroLineColor: "#FFF" },
                ticks: { fontColor: "#FFF" },
            }
        },
        line: { borderColor: ["rgba(20,220,220,.8)", "rgba(220,120,120,.8)", "rgba(20,120,220,.8)"], "borderDash": [[5, 10], [0, 0]] },
        bar: { backgroundColor: ["rgba(20,220,220,.8)", "rgba(220,120,120,.8)", "rgba(20,120,220,.8)"] },
        pie: { backgroundColor: [["rgba(0,0,0,.8)", "rgba(220,20,20,.8)", "rgba(20,220,20,.8)", "rgba(220,220,20,.8)", "rgba(20,20,220,.8)"]] },
        radar: { borderColor: ["rgba(20,220,220,.8)", "rgba(220,120,120,.8)", "rgba(20,120,220,.8)"] },
    },
    anything: [ 
	 {
	  className: "mermaid"
	 },
	 // ...
	],
    menu: {
        // Specifies which side of the presentation the menu will 
        // be shown. Use 'left' or 'right'.
        side: 'left',

            // Specifies the width of the menu.
            // Can be one of the following:
            // 'normal', 'wide', 'third', 'half', 'full', or
            // any valid css length value
            width: 'normal',

                // Add slide numbers to the titles in the slide list.
                // Use 'true' or format string (same as reveal.js slide numbers)
                numbers: false,

                    // Specifies which slide elements will be used for generating
                    // the slide titles in the menu. The default selects the first
                    // heading element found in the slide, but you can specify any
                    // valid css selector and the text from the first matching
                    // element will be used.
                    // Note: that a section data-menu-title attribute or an element
                    // with a menu-title class will take precedence over this option
                    titleSelector: 'h1, h2, h3, h4, h5, h6',

                        // If slides do not have a matching title, attempt to use the
                        // start of the text content as the title instead
                        useTextContentForMissingTitles: false,

                            // Hide slides from the menu that do not have a title.
                            // Set to 'true' to only list slides with titles.
                            hideMissingTitles: false,

                                // Adds markers to the slide titles to indicate the 
                                // progress through the presentation. Set to 'false'
                                // to hide the markers.
                                markers: true,

                                    // Specify custom panels to be included in the menu, by
                                    // providing an array of objects with 'title', 'icon'
                                    // properties, and either a 'src' or 'content' property.
                                    // custom: false,
                                    custom: [],
                                        // Specifies the themes that will be available in the themes
                                        // menu panel. Set to 'true' to show the themes menu panel
                                        // with the default themes list. Alternatively, provide an
                                        // array to specify the themes to make available in the
                                        // themes menu panel, for example...
                                        // [
                                        //     { name: 'Black', theme: 'css/theme/black.css' },
                                        //     { name: 'White', theme: 'css/theme/white.css' },
                                        //     { name: 'League', theme: 'css/theme/league.css' }
                                        // ]
                                        themes: false,

                                            // Specifies the path to the default theme files. If your
                                            // presentation uses a different path to the standard reveal
                                            // layout then you need to provide this option, but only
                                            // when 'themes' is set to 'true'. If you provide your own 
                                            // list of themes or 'themes' is set to 'false' the 
                                            // 'themesPath' option is ignored.
                                            themesPath: 'css/theme/',

                                                // Specifies if the transitions menu panel will be shown.
                                                // Set to 'true' to show the transitions menu panel with
                                                // the default transitions list. Alternatively, provide an
                                                // array to specify the transitions to make available in
                                                // the transitions panel, for example...
                                                // ['None', 'Fade', 'Slide']
                                                transitions: false,

                                                    // Adds a menu button to the slides to open the menu panel.
                                                    // Set to 'false' to hide the button.
                                                    openButton: true,

                                                        // If 'true' allows the slide number in the presentation to
                                                        // open the menu panel. The reveal.js slideNumber option must 
                                                        // be displayed for this to take effect
                                                        openSlideNumber: false,

                                                            // If true allows the user to open and navigate the menu using
                                                            // the keyboard. Standard keyboard interaction with reveal
                                                            // will be disabled while the menu is open.
                                                            keyboard: true,

                                                                // Normally the menu will close on user actions such as
                                                                // selecting a menu item, or clicking the presentation area.
                                                                // If 'true', the sticky option will leave the menu open
                                                                // until it is explicitly closed, that is, using the close
                                                                // button or pressing the ESC or m key (when the keyboard 
                                                                // interaction option is enabled).
                                                                sticky: false,

                                                                    // If 'true' standard menu items will be automatically opened
                                                                    // when navigating using the keyboard. Note: this only takes 
                                                                    // effect when both the 'keyboard' and 'sticky' options are enabled.
                                                                    autoOpen: true,

                                                                        // If 'true' the menu will not be created until it is explicitly
                                                                        // requested by calling RevealMenu.init(). Note this will delay
                                                                        // the creation of all menu panels, including custom panels, and
                                                                        // the menu button.
                                                                        delayInit: false,

                                                                            // If 'true' the menu will be shown when the menu is initialised.
                                                                            openOnInit: false,

                                                                                // By default the menu will load it's own font-awesome library
                                                                                // icons. If your presentation needs to load a different
                                                                                // font-awesome library the 'loadIcons' option can be set to false
                                                                                // and the menu will not attempt to load the font-awesome library.
                                                                                loadIcons: false
    },
    chalkboard: {
        toggleChalkboardButton: { left: "60px", bottom: "30px", top: "auto", right: "auto" },
        toggleNotesButton: { left: "90px", bottom: "30px", top: "auto", right: "auto" },

    }
    });



</script>
</body>

</html>